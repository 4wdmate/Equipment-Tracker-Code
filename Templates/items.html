{% extends "base-facility.html" %}

{% block facility_content %}
    <div class="shift_text_content">
        <h1>Item List</h1>
        <p>Select one of the items below or create a new item by clicking the button below</p>
        <button class="new_item_button" onclick="openModal()">New Item</button>
    </div>
    {% for item in items %}
        <a class="listed_item" href="/facility/{{ facname }}/item/{{ item['itemID'] }}">
            <table style="width:100%;">
                <tr>
                    <td style="width:10%;"><strong>{{ item["itemName"] }}</strong></td>
                    <td style="width:10%;"> ?/{{ item["itemCount"] }} </td>
                    <td style="width:70%;"> {{ item["itemDescription"] }} </td>
                    <td style="width:10%;"> {{ item["facName"] }}-{{ item["itemID"] }} </td>
                </tr>
            </table>
        </a>
    {% endfor %}

    <div id="itemModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Add New Item</h2>

            <form action="/facility/{{ facname }}/items" method="POST">
            <label>Item Name*</label><br>
            <input class="addnewinput" style="width: 30%;" type="text" name="itemName" placeholder="Enter item name" required><br>

            <label>Count*</label><br>
            <input class="addnewinput" style="width: 7%;" type="number" name="itemCount" min="1" value=1 required><br>

            <label>Description</label><br>
            <textarea class="addnewinput" name="itemDescription" placeholder="Enter description here"></textarea><br>

            <label>Room / location</label><br>
            <input class="addnewinput" style="width: 20%;" type="text" name="itemLocation" placeholder="eg, C25"><br>

            <label>Purchase Date</label><br>
            <input class="addnewinput" style="width: auto;" type="date" name="itemPurchaseDate"></input><br>

            <label>Notes</label><br>
            <textarea class="addnewinput" style="height: 60px;" name="itemNotes" placeholder="Enter any additional notes here"></textarea><br>

            <button class="submitbutton" type="submit">Add</button>
            </form>
        </div>
    </div>

    <script>
        function openModal() {
        document.getElementById("itemModal").style.display = "flex";
        }

        function closeModal() {
        document.getElementById("itemModal").style.display = "none";
        }

        // Also close if user clicks outside the modal
        window.onclick = function(event) {
        let modal = document.getElementById("itemModal");
        if (event.target === modal) {
            modal.style.display = "none";
        }
        }
    </script>
{% endblock %} 
